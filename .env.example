# Backend Environment Configuration
# Copy this file to .env and fill in your actual values
# IMPORTANT: Never commit .env file with real credentials to version control

# =============================================================================
# OpenAI API Configuration (Required ONLY for AI Analysis Feature)
# =============================================================================
# Get your API key from: https://platform.openai.com/api-keys
OPENAI_API_KEY=sk-your-openai-api-key-here
OPENAI_MODEL=gpt-4o

# OpenAI Pricing Configuration (per 1M tokens) - Standard API pricing
# Update these values from https://openai.com/api/pricing/
OPENAI_INPUT_PRICE_PER_MILLION=2.50
OPENAI_OUTPUT_PRICE_PER_MILLION=10.00

# =============================================================================
# Tesseract OCR Configuration (Required for Contract OCR Feature)
# =============================================================================
# Path to Tesseract executable (optional - only needed for non-standard installations)
# Windows example: TESSERACT_CMD=C:/Program Files/Tesseract-OCR/tesseract.exe
# macOS/Linux: Usually not needed as tesseract is in PATH after installation
# TESSERACT_CMD=/usr/local/bin/tesseract

# =============================================================================
# Application Configuration (Optional - uses defaults if not set)
# =============================================================================

# Debug mode (true/false)
# VARIANCE_APP__DEBUG=false

# Logging level (DEBUG, INFO, WARNING, ERROR, CRITICAL)
# VARIANCE_APP__LOG_LEVEL=INFO

# CORS origins (comma-separated for multiple origins)
# VARIANCE_APP__CORS_ORIGINS=*

# =============================================================================
# AI Analysis Configuration (Optional)
# =============================================================================

# Enable/disable AI analysis globally
# VARIANCE_AI_ANALYSIS__ENABLE_AI_ANALYSIS=true

# Use LLM for analysis
# VARIANCE_AI_ANALYSIS__USE_LLM_ANALYSIS=false

# Maximum retries for AI calls
# VARIANCE_AI_ANALYSIS__MAX_AI_RETRIES=3

# AI timeout in seconds
# VARIANCE_AI_ANALYSIS__AI_TIMEOUT_SECONDS=300

# =============================================================================
# File Processing Configuration (Optional)
# =============================================================================

# Maximum file size in bytes (default: 100MB)
# VARIANCE_FILE_PROCESSING__MAX_FILE_SIZE=104857600

# Maximum files per upload request (default: 10, configured: 50)
# VARIANCE_FILE_PROCESSING__MAX_FILES_PER_REQUEST=50

# =============================================================================
# Security Configuration (Optional)
# =============================================================================

# Session timeout in minutes
# VARIANCE_SECURITY__SESSION_TIMEOUT_MINUTES=60

# Maximum concurrent sessions
# VARIANCE_SECURITY__MAX_CONCURRENT_SESSIONS=10

# Rate limit: requests per minute
# VARIANCE_SECURITY__RATE_LIMIT_REQUESTS_PER_MINUTE=100

# =============================================================================
# Analysis Thresholds (Optional - Advanced Configuration)
# =============================================================================

# Revenue change threshold in VND
# VARIANCE_REVENUE_ANALYSIS__REVENUE_CHANGE_THRESHOLD_VND=1000000

# COGS change threshold in VND
# VARIANCE_REVENUE_ANALYSIS__COGS_CHANGE_THRESHOLD_VND=500000

# SG&A change threshold in VND
# VARIANCE_REVENUE_ANALYSIS__SGA_CHANGE_THRESHOLD_VND=500000

# Materiality threshold in VND
# VARIANCE_CORE_ANALYSIS__MATERIALITY_VND=1000000000

# =============================================================================
# Gemini API Configuration (Required for Bank Statement PDF OCR)
# =============================================================================
# Get your API key from: https://aistudio.google.com/app/apikey
GEMINI_API_KEY=your-gemini-api-key-here
GEMINI_MODEL=gemini-2.0-flash

# =============================================================================
# Database Configuration (PostgreSQL)
# =============================================================================
#
# === OPTION 1: Cloud Deployment (e.g., Neon, Supabase, AWS RDS) ===
# DATABASE_URL=postgresql://username:password@host:port/database?sslmode=require
DATABASE_URL=postgresql://user:password@localhost:5432/dataprocessingdb
DATABASE__SSL_MODE=prefer
DATABASE__POOL_SIZE=5
DATABASE__MAX_OVERFLOW=10
DATABASE__ECHO=false

# === OPTION 2: Local Development with separate fields ===
# Uncomment below and comment DATABASE_URL above to use local PostgreSQL:
# DATABASE__HOST=localhost
# DATABASE__PORT=5432
# DATABASE__NAME=dataprocessingdb
# DATABASE__USER=postgres
# DATABASE__PASSWORD=your-secure-password-here
# DATABASE__SSL_MODE=prefer

# =============================================================================
# Redis Cache Configuration (Optional)
# =============================================================================
# Redis connection URL (local or cloud like Upstash, Redis Cloud)
# Format: redis://[[username:]password@]host[:port][/database]
# For TLS: rediss://...
REDIS_URL=redis://localhost:6379/0

# Enable/disable Redis caching (default: true)
# Set to false for development to always get fresh parser results
REDIS_ENABLED=false

# OCR cache TTL in seconds (default: 604800 = 7 days)
REDIS_OCR_CACHE_TTL=604800

# AI analysis cache TTL in seconds (default: 604800 = 7 days)
REDIS_AI_CACHE_TTL=604800

# =============================================================================
# Google OAuth & JWT Authentication
# =============================================================================
# Get credentials from: https://console.cloud.google.com/apis/credentials
AUTH__GOOGLE_CLIENT_ID=your-google-client-id.apps.googleusercontent.com
AUTH__GOOGLE_CLIENT_SECRET=your-google-client-secret
AUTH__GOOGLE_REDIRECT_URI=http://localhost:3001/auth/callback

# JWT Secret Key (min 32 characters - generate a random string)
# Generate with: python -c "import secrets; print(secrets.token_urlsafe(32))"
AUTH__JWT_SECRET_KEY=your-secure-jwt-secret-key-min-32-chars

# Token expiration
AUTH__ACCESS_TOKEN_EXPIRE_MINUTES=15
AUTH__REFRESH_TOKEN_EXPIRE_DAYS=30

# Optional: Restrict to specific email domains (comma-separated, empty = all allowed)
# AUTH__ALLOWED_EMAIL_DOMAINS=yourcompany.com

# Maximum sessions per user
AUTH__MAX_SESSIONS_PER_USER=5

# =============================================================================
# Default Admin User (Auto-created on startup if not exists)
# =============================================================================
# IMPORTANT: Change these values in production!
ADMIN_USERNAME=admin
ADMIN_PASSWORD=ChangeThisSecurePassword123!
ADMIN_EMAIL=admin@yourcompany.com
ADMIN_FULL_NAME=System Admin

